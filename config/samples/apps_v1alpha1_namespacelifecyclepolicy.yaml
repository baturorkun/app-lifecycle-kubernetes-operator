apiVersion: apps.ops.dev/v1alpha1
kind: NamespaceLifecyclePolicy
metadata:
  labels:
    app.kubernetes.io/name: app-lifecycle-kubernetes-operator
    app.kubernetes.io/managed-by: kustomize
  name: namespacelifecyclepolicy-sample
spec:
  # --- MANDATORY FIELDS ---

  # targetNamespace specifies the name of the namespace to which this policy applies.
  # This field is required and must reference an existing namespace.
  targetNamespace: production

  # action defines the lifecycle operation to perform.
  # Valid values: "Freeze", "Resume"
  action: Resume

  # startupPolicy defines the behavior when the operator starts.
  # Valid values: "Ignore", "Resume", "Freeze"
  startupPolicy: Resume

  # --- OPTIONAL FIELDS ---

  # operationId is an optional identifier for this operation.
  # Can be used for tracking and correlation purposes.
  # operationId: "op-123456789-2"

  # balancePods enables automatic pod redistribution when new nodes become Ready
  # after a Resume operation. Only applies when action is Resume.
  # balancePods: true

  # balanceWindowSeconds defines how long (in seconds) after resume tsimdihe operator
  # will automatically trigger rolling restarts. Only used if balancePods is true.
  # Default: 600 (10 minutes). Range: 0-3600
  # balanceWindowSeconds: 600

  # terminationGracePeriodSeconds defines graceful shutdown overrides for different resource types
  # during the Freeze operation. Original values are restored during Resume.
  # Range: 0-300 seconds.
  # terminationGracePeriodSeconds:
  #   deployment: 10
  #   statefulSet: 60

  # startupNodeReadinessPolicy defines node readiness requirements before applying startup policy.
  # Only applies when startupPolicy is Resume or Freeze.
  # This helps ensure pods are distributed across all available nodes when operator starts.
  # startupNodeReadinessPolicy:
  #   enabled: true
  #   timeoutSeconds: 120         # Wait max 2 minutes for nodes
  #   requireAllNodes: true        # REQUIRED: true = all nodes, false = use minReadyNodes
  #   minReadyNodes: 2             # Only used when requireAllNodes: false
  #   nodeSelector:
  #     node-role.kubernetes.io/worker: ""

  # selector is optional - if not specified, all Deployments and StatefulSets will be affected
  # selector:
  #   matchLabels:
  #     app: myapp
  #     environment: production
  #   matchExpressions:
  #   - key: tier
  #     operator: In
  #     values:
  #     - frontend
  #     - backend
